(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e008498a"],{9270:function(t,e,a){"use strict";a.d(e,"f",(function(){return n})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"g",(function(){return d})),a.d(e,"c",(function(){return c})),a.d(e,"b",(function(){return u}));var l=a("b775");function n(t,e){var a="";return Object(l["a"])({url:"/userAuth/searchRole?page="+t.page+"&pageSize="+t.pageSize+a,method:"get"})}function r(){return Object(l["a"])({url:"/userAuth/getAllAuthList",method:"get"})}function i(){return Object(l["a"])({url:"/userAuth/getAllRoleList",method:"get"})}function o(t){return Object(l["a"])({url:"/userAuth/roleAdd",method:"post",data:t})}function d(t){return Object(l["a"])({url:"/userAuth/roleUpdate",method:"post",data:t})}function c(t){return Object(l["a"])({url:"/userAuth/roleDelete",method:"post",data:t})}function u(t){return Object(l["a"])({url:"/userAuth/allotRole",method:"post",data:t})}},a58d:function(t,e,a){"use strict";a.r(e);var l,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticStyle:{"max-width":"95%","margin-top":"20px","margin-left":"20px"}},[a("div",{staticStyle:{display:"inline-block","margin-left":"0px","margin-top":"0px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchQuery}},[t._v("刷新")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.addData(!0)}}},[t._v("新增")])],1)]),a("el-card",{staticStyle:{"max-width":"95%","margin-top":"10px","margin-left":"20px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"empty-text":"暂无数据",stripe:"",border:"","header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},data:t.page.data}},[a("el-table-column",{attrs:{prop:"roleId",label:"角色id"}}),a("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"createTime",label:"更新时间"}}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.updateData(e.row,!0)}}},[t._v("修改")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.deleteData(e.row.roleId)}}},[t._v("删除")])]}}])})],1),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"empty-text":"暂无数据",background:"","current-page":t.page.page,"page-sizes":[5,10,20,50],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1),a("el-dialog",{attrs:{title:"修改",visible:t.updateDataVar.dig,width:"30%","before-close":function(){t.updateDataVar.dig=!1}},on:{"update:visible":function(e){return t.$set(t.updateDataVar,"dig",e)}}},[a("span",{staticClass:"el-form-item__label",staticStyle:{"font-weight":"bold"}},[t._v("角色名称")]),a("div",[a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"角色名称"},model:{value:t.updateDataVar.roleName,callback:function(e){t.$set(t.updateDataVar,"roleName",e)},expression:"updateDataVar.roleName"}})],1),a("div",[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("权限")]),a("el-tree",{ref:"tree",staticStyle:{"margin-top":"10px"},attrs:{"node-key":"authId","show-checkbox":"","render-after-expand":!1,data:t.data,props:t.defaultProps},on:{"check-change":t.handleCheckChangeUpdate,"node-click":t.handleNodeClick}})],1),a("p"),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateData(null,!1)}}},[t._v("确认修改")])],1),a("el-dialog",{attrs:{title:"新增",visible:t.addDataVar.dig,width:"30%","before-close":function(){t.addDataVar.dig=!1}},on:{"update:visible":function(e){return t.$set(t.addDataVar,"dig",e)}}},[a("span",{staticClass:"el-form-item__label",staticStyle:{"font-weight":"bold"}},[t._v("角色名称")]),a("div",[a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"角色名称"},model:{value:t.addDataVar.roleName,callback:function(e){t.$set(t.addDataVar,"roleName",e)},expression:"addDataVar.roleName"}})],1),a("div",[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("权限")]),a("el-tree",{ref:"tree",staticStyle:{"margin-top":"10px"},attrs:{"node-key":"authId","show-checkbox":"","render-after-expand":!1,data:t.data,props:t.defaultProps},on:{"check-change":t.handleCheckChange,"node-click":t.handleNodeClick}})],1),a("p"),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData(!1)}}},[t._v("保存")])],1)],1)},r=[],i=(a("4de4"),a("caad"),a("d3b7"),a("2532"),a("f09d"),a("9270")),o={computed:{},components:{searchDataApi:i["f"],updateDataApi:i["g"],deleteDataApi:i["c"],addDataApi:i["a"],getAllAuthListApi:i["d"]},created:function(){l=this,console.log("创建"),l.searchData(),l.getAllAuthListApi()},methods:{handleSizeChange:function(t){console.log("每页 ".concat(t," 条")),l.page.pageSize=t,l.searchData()},handleCurrentChange:function(t){console.log("当前页: ".concat(t)),l.page.page=t,l.searchData()},handleCheckChange:function(t,e,a){if(!("children"in t)){if(console.log(t,e,a),e)l.addDataVar.authList.includes(t.authId)||l.addDataVar.authList.push(t.authId);else{var n=t.authId;l.addDataVar.authList=l.addDataVar.authList.filter((function(t){return t!==n}))}console.log("最终的authList",l.addDataVar.authList)}},handleCheckChangeUpdate:function(t,e,a){if(!("children"in t)){if(console.log(t,e,a),e)l.updateDataVar.authList.includes(t.authId)||l.updateDataVar.authList.push(t.authId);else{var n=t.authId;l.updateDataVar.authList=l.updateDataVar.authList.filter((function(t){return t!==n}))}console.log("最终的authList",l.updateDataVar.authList)}},handleNodeClick:function(t){},getAllAuthListApi:function(){Object(i["d"])(l.page,l.query).then((function(t){l.authListAll=t.data;for(var e=[],a=0;a<l.authListAll.length;a++){for(var n=l.authListAll[a],r=!1,i=0;i<e.length;i++)if(n.classify===e[i].label){r=!0;break}r||e.push({label:n.classify,children:[],authId:n.classify})}for(var o=0;o<l.authListAll.length;o++)for(var d=l.authListAll[o],c=0;c<e.length;c++){var u=e[c];d.classify===u.label&&u.children.push({label:d.authName,authId:d.authId})}console.log(e),l.data=e}))},searchData:function(){Object(i["f"])(l.page,l.query).then((function(t){l.page=t.data}))},searchQuery:function(){this.page.page=1,Object(i["f"])(l.page,l.query).then((function(t){l.page=t.data}))},deleteData:function(t){var e=this;l.deleteDataVar.roleId=t,this.$confirm("删除角色后该角色下所有用户将分配至默认权限","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["c"])(l.deleteDataVar).then((function(t){l.searchData()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},addData:function(t){var e=this;t?(l.addDataVar.dig=!0,l.addDataVar.authList=[],this.$nextTick((function(){e.$refs.tree.setCheckedKeys([])}))):Object(i["a"])(l.addDataVar).then((function(t){l.addDataVar.dig=!1,l.$msg("添加成功",1),l.searchData()}))},updateData:function(t,e){var a=this;e?(l.updateDataVar.dig=!0,l.updateDataVar.roleId=t.roleId,l.updateDataVar.roleName=t.roleName,console.log(t.authLists),this.$nextTick((function(){a.$refs.tree.setCheckedKeys([]),a.$refs.tree.setCheckedKeys(t.authLists)}))):Object(i["g"])(l.updateDataVar).then((function(t){l.updateDataVar.dig=!1,l.$msg("修改成功",1),l.searchData()}))}},data:function(){return{data:[{label:"一级 1",children:[{label:"二级 1-1",children:[{label:"三级 1-1-1"}]}]}],defaultProps:{children:"children",label:"label"},page:{pages:0,page:1,pageSize:5,total:0,data:[{}]},authListAllSelect:[{checkAll:!1,checkedCities:[],cities:[],isIndeterminate:!0}],authListAll:[{authId:"",authName:"",classify:""}],addDataVar:{dig:!1,roleName:"",authList:""},updateDataVar:{dig:!1,roleId:"",roleName:"",authList:[]},query:{roleId:"",authList:"",createTime:"",orgId:"",userId:""},deleteDataVar:{roleId:""},isDelete:{tab:[{value:1,label:"是"},{value:0,label:"否"}],value:""}}}},d=o,c=a("2877"),u=Object(c["a"])(d,n,r,!1,null,"2f1b74c4",null);e["default"]=u.exports}}]);