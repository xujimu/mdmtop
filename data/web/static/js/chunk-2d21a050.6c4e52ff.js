(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21a050"],{ba72:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticStyle:{"max-width":"95%","margin-top":"10px","margin-left":"20px"}},[a("div",{staticStyle:{display:"inline-block","margin-left":"0px","margin-top":"20px"}},[a("span",{staticClass:"el-form-item__label",staticStyle:{"font-weight":"bold"}},[t._v("证书id")]),a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书id"},model:{value:t.query.abmId,callback:function(e){t.$set(t.query,"abmId",e)},expression:"query.abmId"}})],1),a("div",{staticStyle:{display:"inline-block","margin-left":"0px","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.addData(!1)}}},[t._v("新增")])],1),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{"empty-text":"暂无数据",stripe:"",border:"","header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},data:t.page.data}},[a("el-table-column",{attrs:{prop:"abmId",label:"证书id",width:"180"}}),a("el-table-column",{attrs:{prop:"name",label:"mdm服务器名称",width:"180"}}),a("el-table-column",{attrs:{prop:"certId",label:"mdm证书id",width:"180"}}),a("el-table-column",{attrs:{prop:"createTime",label:"添加时间",width:"180"}}),a("el-table-column",{attrs:{prop:"expireTime",label:"过期时间",width:"180"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"180"}}),a("el-table-column",{attrs:{prop:"status",label:"证书状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?a("el-tag",{attrs:{type:"success"}},[t._v("正常")]):t._e(),0===e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("失效")]):t._e(),2===e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("过期")]):t._e(),3===e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("等待上传p7m")]):t._e(),4===e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("已删除")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"isPublic",label:"归属",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.isPublic?a("el-tag",{attrs:{type:"success"}},[t._v("公有")]):t._e(),0===e.row.isPublic?a("el-tag",{attrs:{type:"danger"}},[t._v("自有")]):t._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.checkIsShow(e.row)?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.updateData(e.row,!1)}}},[t._v("更新p7m文件")]):t._e(),t.checkIsShow(e.row)?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.downPubilcKey(e.row.abmId)}}},[t._v("下载公钥")]):t._e()]}}])})],1),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"empty-text":"暂无数据",background:"","current-page":t.page.page,"page-sizes":[5,10,20,50],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1),a("el-dialog",{attrs:{title:"更新p7m文件",visible:t.update.localDialogVisible,width:"30%","before-close":t.closeDialog},on:{"update:visible":function(e){return t.$set(t.update,"localDialogVisible",e)}}},[a("div",[a("span",{staticStyle:{"font-weight":"bold","margin-right":"20px"}},[t._v("证书备注")]),a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书备注"},model:{value:t.update.remark,callback:function(e){t.$set(t.update,"remark",e)},expression:"update.remark"}})],1),a("div",[a("span",{staticStyle:{"font-weight":"bold","margin-right":"20px"}},[t._v("证书文件")]),a("input",{ref:"updateFileInput",staticStyle:{"margin-top":"10px"},attrs:{type:"file",accept:".p7m"},on:{change:t.handleFileChange}})]),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.updateData(null,!0)}}},[t._v("确认修改")])],1),a("el-dialog",{attrs:{title:"新增证书",visible:t.add.dig,width:"30%","before-close":t.closeAddDialog},on:{"update:visible":function(e){return t.$set(t.add,"dig",e)}}},[a("div",[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("mdm证书id")]),a("el-input",{staticStyle:{width:"200px","margin-left":"20px","margin-bottom":"20px"},attrs:{placeholder:"mdm证书Id"},model:{value:t.add.certId,callback:function(e){t.$set(t.add,"certId",e)},expression:"add.certId"}})],1),a("div",[a("span",{staticStyle:{"font-weight":"bold","margin-right":"20px"}},[t._v("证书备注")]),a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书备注"},model:{value:t.add.remark,callback:function(e){t.$set(t.add,"remark",e)},expression:"add.remark"}})],1),a("div",[a("span",{staticStyle:{"font-weight":"bold","margin-right":"20px"}},[t._v("证书名称")]),a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"名称"},model:{value:t.add.name,callback:function(e){t.$set(t.add,"name",e)},expression:"add.name"}})],1),a("div",[a("el-button",{staticStyle:{"margin-top":"0px"},attrs:{type:"primary"},on:{click:function(e){return t.addData(!0)}}},[t._v("确认添加")])],1)])],1)},l=[],n=a("5530"),r=a("b775");function s(t,e){var a="";return""!==e.abmId&&(a=a+"&abmId="+e.abmId),Object(r["a"])({url:"/abmP7m/search?page="+t.page+"&pageSize="+t.pageSize+a,method:"get"})}function o(t){return Object(r["a"])({url:"/abmP7m/add",method:"post",data:t})}function d(t){return Object(r["a"])({url:"/abmP7m/uploadP7m",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/abmP7m/downPubilcKey?abmId="+t,method:"get"})}var p=a("2f62"),u=a("27aa"),g={computed:Object(n["a"])({fa:function(){return u["a"]}},Object(p["c"])({userInfo:function(t){return t.user.userInfo.user}})),data:function(){return{page:{pages:0,page:1,pageSize:5,total:0,data:[]},query:{abmId:""},update:{localDialogVisible:!1,p7mBase64:"",abmId:"",remark:""},add:{dig:!1,name:"",remark:"",certId:""}}},created:function(){this.getList()},methods:{downPubilcKey:function(t){c(t).then((function(t){window.location.href=t.data}))},checkIsShow:function(t){return console.log(t),t.userId===this.userInfo.userId},handleFileChange:function(t){var e=this,a=t.target.files[0];if(a){var i=new FileReader;i.readAsDataURL(a),i.onload=function(){e.update.p7mBase64=i.result.split(",")[1]}}},handleFileChangeAdd:function(t){var e=this,a=t.target.files[0];if(a){var i=new FileReader;i.readAsDataURL(a),i.onload=function(){e.add.p12Base64=i.result.split(",")[1]}}},handleSizeChange:function(t){this.page.pageSize=t,this.getList()},handleCurrentChange:function(t){this.page.page=t,this.getList()},getList:function(){var t=this;s(this.page,this.query).then((function(e){t.page=e.data}))},search:function(){var t=this;s(this.page,this.query).then((function(e){t.page=e.data}))},updateData:function(t,e){var a=this;e?(d(this.update).then((function(t){a.$message.success("修改成功"),a.getList()})),this.update.localDialogVisible=!1):(this.$refs.updateFileInput&&(this.$refs.updateFileInput.value=""),this.update.abmId=t.abmId,this.update.localDialogVisible=!0)},closeDialog:function(){this.update.localDialogVisible=!1},addData:function(t){var e=this;t?o(this.add).then((function(t){e.$message.success("添加成功"),e.getList(),e.add.dig=!1})):(this.$refs.addFileInput&&(this.$refs.addFileInput.value=""),this.add.dig=!0)},closeAddDialog:function(){this.add.dig=!1}}},m=g,h=a("2877"),b=Object(h["a"])(m,i,l,!1,null,"4a46d694",null);e["default"]=b.exports}}]);