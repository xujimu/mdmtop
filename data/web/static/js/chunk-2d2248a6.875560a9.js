(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2248a6"],{e126:function(t,e,a){"use strict";a.r(e);var l,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticStyle:{"max-width":"95%","margin-top":"10px","margin-left":"20px"}},[a("div",{staticStyle:{display:"inline-block","margin-left":"0px","margin-top":"20px"}},[a("span",{staticClass:"el-form-item__label",staticStyle:{"font-weight":"bold"}},[t._v("证书id")]),a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书id"},model:{value:t.query.certId,callback:function(e){t.$set(t.query,"certId",e)},expression:"query.certId"}})],1),a("div",{staticStyle:{display:"inline-block","margin-left":"0px","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.addData(!1)}}},[t._v("新增")])],1),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{"empty-text":"暂无数据",stripe:"",border:"","header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"},data:t.page.data}},[a("el-table-column",{attrs:{prop:"certId",label:"证书id",width:"180"}}),a("el-table-column",{attrs:{prop:"topicId",label:"topicId",width:"180"}}),a("el-table-column",{attrs:{prop:"certName",label:"证书名称",width:"180"}}),a("el-table-column",{attrs:{prop:"p12Password",label:"证书密码",width:"180"}}),a("el-table-column",{attrs:{prop:"certStatus",label:"证书状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.certStatus?a("el-tag",{attrs:{type:"success"}},[t._v("正常")]):t._e(),2===e.row.certStatus?a("el-tag",{attrs:{type:"danger"}},[t._v("过期")]):t._e(),3===e.row.certStatus?a("el-tag",{attrs:{type:"danger"}},[t._v("吊销")]):t._e(),0===e.row.certStatus?a("el-tag",{attrs:{type:"danger"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"isPublic",label:"归属",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.isPublic?a("el-tag",{attrs:{type:"success"}},[t._v("公有")]):t._e(),0===e.row.isPublic?a("el-tag",{attrs:{type:"danger"}},[t._v("自有")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"serialNumber",label:"证书序列号",width:"180"}}),a("el-table-column",{attrs:{prop:"createTime",label:"添加时间",width:"180"}}),a("el-table-column",{attrs:{prop:"endTime",label:"过期时间",width:"180"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.checkIsShow(e.row)?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.updateData(e.row,!1)}}},[t._v("修改")]):t._e()]}}])})],1),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"empty-text":"暂无数据",background:"","current-page":t.page.page,"page-sizes":[5,10,20,50],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1),a("el-dialog",{attrs:{title:"修改证书",visible:t.update.localDialogVisible,width:"30%","before-close":t.closeDialog}},[a("div",[a("span",{staticStyle:{"font-weight":"bold","margin-right":"20px"}},[t._v("证书密码")]),a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书名称"},model:{value:t.update.password,callback:function(e){t.$set(t.update,"password",e)},expression:"update.password"}})],1),a("div",[a("span",{staticStyle:{"font-weight":"bold","margin-right":"20px"}},[t._v("证书备注")]),a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书备注"},model:{value:t.update.remark,callback:function(e){t.$set(t.update,"remark",e)},expression:"update.remark"}})],1),a("div",[a("span",{staticStyle:{"font-weight":"bold","margin-right":"20px"}},[t._v("证书文件")]),a("input",{ref:"updateFileInput",staticStyle:{"margin-top":"10px"},attrs:{type:"file",accept:".p12"},on:{change:t.handleFileChange}})]),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.updateData(null,!0)}}},[t._v("确认修改")])],1),a("el-dialog",{attrs:{title:"新增证书",visible:t.add.dig,width:"30%","before-close":function(){t.add.dig=!1}}},[a("span",{staticClass:"el-form-item__label",staticStyle:{"font-weight":"bold"}},[t._v("证书密码")]),a("div",[a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书密码"},model:{value:t.add.password,callback:function(e){t.$set(t.add,"password",e)},expression:"add.password"}})],1),a("span",{staticClass:"el-form-item__label",staticStyle:{"font-weight":"bold"}},[t._v("证书备注")]),a("div",[a("el-input",{staticStyle:{width:"200px","margin-right":"20px","margin-bottom":"20px"},attrs:{placeholder:"证书备注"},model:{value:t.add.remark,callback:function(e){t.$set(t.add,"remark",e)},expression:"add.remark"}})],1),a("span",{staticClass:"el-form-item__label",staticStyle:{"font-weight":"bold"}},[t._v("证书文件")]),a("div",[a("input",{ref:"addFileInput",staticStyle:{"margin-top":"10px"},attrs:{type:"file",accept:".p12"},on:{change:t.handleFileChangeAdd}})]),a("div",[a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.addData(!0)}}},[t._v("确认添加")])],1)])],1)},r=[],n=a("5530"),s=a("2f62"),o=a("b775");function d(t,e){var a="";return""!==e.certId&&(a=a+"&certId="+e.certId),Object(o["a"])({url:"/mdmCert/search?page="+t.page+"&pageSize="+t.pageSize+a,method:"get"})}function p(t){return Object(o["a"])({url:"/mdmCert/add",method:"post",data:t})}function c(t){return Object(o["a"])({url:"/mdmCert/update",method:"post",data:t})}function u(t){return Object(o["a"])({url:"/mdmCert/delete?certId="+t,method:"get"})}var g={computed:Object(n["a"])({},Object(s["c"])({userInfo:function(t){return t.user.userInfo.user}})),components:{searchApi:d,addApi:p,updateApi:c,deleteApi:u},created:function(){l=this,console.log("创建"),l.getList()},methods:{checkIsShow:function(t){return console.log(t),t.userId===this.userInfo.userId},handleFileChange:function(t){var e=this,a=t.target.files[0];if(a){var l=new FileReader;l.readAsDataURL(a),l.onload=function(){console.log("证书base64",l.result.split(",")[1]),e.update.p12Base64=l.result.split(",")[1]}}},handleFileChangeAdd:function(t){var e=this,a=t.target.files[0];if(a){var l=new FileReader;l.readAsDataURL(a),l.onload=function(){console.log("证书base64",l.result.split(",")[1]),e.add.p12Base64=l.result.split(",")[1]}}},handleSizeChange:function(t){console.log("每页 ".concat(t," 条")),l.page.pageSize=t,l.page.page=1,l.getList()},handleCurrentChange:function(t){console.log("当前页: ".concat(t)),l.page.page=t,l.getList()},getList:function(){d(l.page,l.query).then((function(t){l.page=t.data}))},search:function(){this.page.page=1,d(l.page,l.query).then((function(t){l.page=t.data}))},updateData:function(t,e){e?(c(this.update).then((function(t){l.$msg("修改成功",1),l.getList()})),l.update.localDialogVisible=!1):("updateFileInput"in this.$refs&&"value"in this.$refs.updateFileInput&&(this.$refs.updateFileInput.value=""),l.update.certId=t.certId,l.update.p12Base64="",l.update.localDialogVisible=!0)},closeDialog:function(){this.update.localDialogVisible=!1},closeWpDialog:function(){this.wpTempDig=!1},addData:function(t){t?p(l.add).then((function(t){l.$msg("添加成功",1),l.getList(),l.add.dig=!1})):(console.log(this.$refs.addFileInput),"addFileInput"in this.$refs&&"value"in this.$refs.addFileInput&&(this.$refs.addFileInput.value=""),l.add.p12Base64="",l.add.dig=!0)}},data:function(){return{page:{pages:0,page:1,pageSize:5,total:0,data:[{}]},query:{certId:""},update:{localDialogVisible:!1,certId:"",password:"",p12Base64:"",remark:""},add:{dig:!1,p12Base64:"",password:"",remark:""}}}},h=g,m=a("2877"),f=Object(m["a"])(h,i,r,!1,null,"4c7d788d",null);e["default"]=f.exports}}]);